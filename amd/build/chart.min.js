/**
 * Describe different types of charts.
 *
 * @module     block_learnerscript/chart
 * @copyright  2023 Moodle India Information Solutions Private Limited
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("block_learnerscript/chart",["jquery","core/ajax","block_learnerscript/highcharts","block_learnerscript/smartfilter","core/str"],(function($,Ajax,Highcharts,smartfilter,Str){var chart={HighchartsAjax:function(args){Str.get_string("nodataavailable","block_learnerscript").then((function(s){if(args.cols=JSON.stringify(args.cols),args.instanceid=args.reportid,args.filters=args.filters||smartfilter.FilterData(args.instanceid),args.basicparams=JSON.stringify(smartfilter.BasicparamsData(args.instanceid)),args.filters.lsfstartdate=$("#lsfstartdate").val(),args.filters.lsfenddate=$("#lsfenddate").val(),void 0===args.filters.filter_courses){var filter_courses=$(".dashboardcourses").val();1!=filter_courses&&(args.filters.filter_courses=filter_courses)}args.filters=JSON.stringify(args.filters);var promise=Ajax.call([{methodname:"block_learnerscript_generate_plotgraph",args:args}]);$("#report_plottabs").show(),$("#plotreportcontainer"+args.instanceid).html('<img src="'+M.util.image_url("loading","block_learnerscript")+'" id="reportloadingimage" />'),promise[0].done((function(response){(response=JSON.parse(response)).plot&&(!0===response.plot.error?$("#plotreportcontainer"+args.instanceid).html("<div class='alert alert-warning'>"+s+"</div>"):(response.plot.reportid=args.reportid,response.plot.reportinstance=args.reportid,response.plot.data&&response.plot.data.length>0?require(["block_learnerscript/report"],(function(report){report.generate_plotgraph(response.plot)})):$("#plotreportcontainer"+args.instanceid).html("<div class='alert alert-warning'>"+s+"</div>")))}))}))},piechart:function(chartdata){Highcharts.chart(chartdata.containerid,{chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie",width:chartdata.width||null,height:chartdata.height||null,margin:chartdata.margin||null},credits:{enabled:!1},title:{text:chartdata.title},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b>"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",shadow:!1,dataLabels:{enabled:chartdata.datalabels},showInLegend:chartdata.showlegend}},series:[{name:chartdata.serieslabel,colorByPoint:!0,data:chartdata.data}]})},lbchart:function(chartdata){var charttype=chartdata.type,chartcolors=["#336B87","#90AFC5","#688B8A","#A0B084","#FAEFD4","#A57C65","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"];void 0!==$(chartdata.container).data("chartcolor")&&(chartcolors=["#"+$(chartdata.container).data("chartcolor")]),Highcharts.chart(chartdata.containerid,{chart:{type:charttype,height:chartdata.height||null,zoomType:"x",styledMode:!0},colors:chartcolors,title:{text:chartdata.title},exporting:{enabled:!1},xAxis:{categories:chartdata.categorydata,labels:{enabled:1==chartdata.datalabels},title:{text:chartdata.ylabel}},yAxis:{title:{text:chartdata.pcalcs?chartdata.pcalcs:chartdata.title}},plotOptions:{bar:{dataLabels:{enabled:1==chartdata.datalabels,formatter:function(){return this.point.label}},enableMouseTracking:1!=chartdata.datalabels,borderRadius:5},spline:{dataLabels:{enabled:1==chartdata.datalabels,formatter:function(){return this.point.label}},enableMouseTracking:1!=chartdata.datalabels},column:{dataLabels:{enabled:1===chartdata.datalabels,formatter:function(){return this.point.label}},enableMouseTracking:1!==chartdata.datalabels,borderRadius:5}},tooltip:{pointFormatter:function(){return'<span style="color:'+this.series.color+';">●</span> '+this.series.name+" - "+this.label}},credits:{enabled:!0},legend:{enabled:chartdata.showlegend},series:chartdata.data,responsive:{rules:[{condition:{maxWidth:500},chartOptions:{legend:{align:"center",verticalAlign:"bottom",layout:"horizontal"},yAxis:{labels:{align:"left",x:0,y:10},title:{text:null}},subtitle:{text:null},credits:{enabled:!1}}}]}})},combinationchart:function(chartdata){var chartcolors=["#90AFC5","#336B87","#FAEFD4","#A57C65","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"];void 0!==$(chartdata.container).data("chartcolor")&&(chartcolors=["#"+$(chartdata.container).data("chartcolor")]),Highcharts.chart(chartdata.containerid,{zoomType:"xy",title:{text:chartdata.title},colors:chartcolors,xAxis:{categories:chartdata.categorydata,crosshair:!0,labels:{enabled:1==chartdata.datalabels}},exporting:{enabled:!1},yAxis:[{title:{text:chartdata.name}},{opposite:!0,title:{text:chartdata.name}}],credits:{enabled:!1},tooltip:{pointFormatter:function(){return'<span style="color:'+this.series.color+';">●</span> '+this.series.name+" - "+this.label}},dataLabels:{enabled:1==chartdata.datalabels,formatter:function(){return this.point.label}},legend:{enabled:1==chartdata.showlegend},series:chartdata.data})},HeatMap:function(chartdata){Highcharts.chart("testaccess",{chart:{type:chartdata.type,marginTop:40,marginBottom:80,plotBorderWidth:1},title:{text:null},exporting:{enabled:!1},xAxis:{visible:!0,categories:chartdata.xAxis},yAxis:{visible:!0,categories:chartdata.yAxis,title:null,reversed:!1},colorAxis:{min:0,minColor:"#FFFFFF",maxColor:Highcharts.getOptions().colors[0]},legend:{enabled:!1},series:[{name:"User LMS access",borderWidth:1,data:chartdata.data,dataLabels:{enabled:!0,color:"#000000"}}]})},SparkLines:function(){Highcharts.SparkLine=function(a,b,c){var hasRenderToArg="string"==typeof a||a.nodeName,options=arguments[hasRenderToArg?1:0],defaultOptions={chart:{renderTo:options.chart&&options.chart.renderTo||this,backgroundColor:null,borderWidth:0,type:"area",margin:[2,0,2,0],width:120,height:100,style:{overflow:"visible"},skipClone:!0},title:{text:""},credits:{enabled:!1},exporting:{enabled:!1},xAxis:{labels:{enabled:!1},title:{text:null},startOnTick:!1,endOnTick:!1,tickPositions:[]},yAxis:{endOnTick:!1,startOnTick:!1,labels:{enabled:!1},title:{text:null},tickPositions:[0]},legend:{enabled:!1},tooltip:{backgroundColor:null,borderWidth:0,shadow:!1,useHTML:!0,hideDelay:0,shared:!0,padding:0,positioner:function(w,h,point){return{x:point.plotX-w/2,y:point.plotY-h}}},plotOptions:{series:{animation:!1,lineWidth:1,shadow:!1,states:{hover:{lineWidth:1}},marker:{radius:1,states:{hover:{radius:2}}},fillOpacity:.25},column:{negativeColor:"#910000",borderColor:"silver",borderRadius:15}}};return options=Highcharts.merge(defaultOptions,options),hasRenderToArg?new Highcharts.Chart(a,options,c):new Highcharts.Chart(options,b)}},ProgressBar:function(chartdata){Highcharts.chart(chartdata.containerid,{title:{text:chartdata.title},chart:{renderTo:chartdata.containerid,type:"bar",height:chartdata.height||15,backgroundColor:chartdata.backgroundColor||"transparent",margin:chartdata.margin||null},plotOptions:{bar:{borderRadius:5},series:{cursor:"pointer",point:{events:{click:function(){void 0!==chartdata.data.link&&require("block_learnerscript/helper").ReportModelFromLink({container:$("#"+chartdata.containerid),url:chartdata.data.link})}}}}},exporting:{enabled:!1},credits:chartdata.credits||!1,tooltip:chartdata.tooltip||!1,legend:chartdata.legend||!1,xAxis:{visible:!1},yAxis:{visible:!1,min:0,max:100},series:[{data:[100],grouping:!1,animation:!1,enableMouseTracking:!1,showInLegend:!1,color:"#CCC",pointWidth:15,dataLabels:{className:"highlight",format:chartdata.format||null,enabled:!1,align:"left",style:{color:"#0294A5",textOutline:!1,fontSize:"9px",fontWeight:"normal"}}},{enableMouseTracking:!0,data:chartdata.data||[0],color:"#0294A5",pointWidth:15,animation:{duration:250},dataLabels:{enabled:!0,inside:!0,align:"right",format:"{point.y}%",style:{color:"#FFF",textOutline:!1,fontSize:"9px",fontWeight:"normal"}}}]})},SparkLineReport:function(){var i,$td,stringdata,arr,data,chart,$tds=$(".spark-report"),time=+new Date,len=$tds.length;for(i=0;i<len;i+=1){stringdata=($td=$($tds[i])).data("sparkline");var stringlink=$td.data("link");switch(arr=stringdata.split("; "),(data=$.map(arr[0].split(", "),parseFloat)).link=stringlink,chart={},arr[1]&&(chart.type=arr[1]),chart.containerid=$td.attr("id"),chart.chartname="",chart.datalabels=!1,chart.showlegend=!1,chart.serieslabel=!1,chart.categorydata=$td.text(),arr[1]){case"pie":chart.data=data,chart.width="65",chart.height="65",chart.margin=[0,0,0,0],this.piechart(chart);break;case"spline":case"bar":case"column":chart.data={data:data,name:$td.data("name"),type:"bar"},chart.serieslabel=$td.data("serieslabel"),chart.title=$td.data("title"),this.lbchart(chart);break;case"progressbar":chart.data=data,chart.title=$td.data("title"),chart.width="100",chart.height="15",chart.margin=[0,0,0,0],this.ProgressBar(chart);break;default:this.SparkLines(),Highcharts.SparkLine($td.attr("id"),{title:{text:""},credits:{enabled:!1},series:[{data:data,pointStart:1,dataLabels:{enabled:!1}}],tooltip:{headerFormat:'<span style="font-size: 10px">'+$td.parent().find("th").html()+"<br/> Q{point.x}: </span>",pointFormat:" <b>{point.y}</b>"},chart:chart})}if(new Date-time>500){$tds.splice(0,i+1),setTimeout(this.SparkLineReport,0);break}}}};return chart}));

//# sourceMappingURL=chart.min.js.map