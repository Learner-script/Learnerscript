{"version":3,"file":"helper.min.js","sources":["../src/helper.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * TODO describe module helper\n *\n * @module     block_learnerscript/helper\n * @copyright  2023 YOUR NAME <your@email.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery',\n        'block_learnerscript/ajax',\n        'block_learnerscript/ajaxforms',\n        'core/str',\n        'core/modal_factory',\n        'core/modal_events',\n        'core/ajax',\n        'core/notification',\n        'block_learnerscript/smartfilter',\n        'block_learnerscript/reportwidget',\n        'block_learnerscript/chart'\n    ],\n    function($, ajax, AjaxForms, Str, ModalFactory, ModalEvents, Ajax, notification, smartfilter,\n                reportwidget, chart) {\n        var helper = {\n            sendmessage: function(args, username) {\n                    Str.get_strings([{\n                    key: 'sendmessage',\n                    component: 'block_learnerscript'\n                }, {\n                    key: 'messageconformation',\n                    component: 'block_learnerscript'\n                }, {\n                    key: 'messagesent',\n                    component: 'block_learnerscript'\n                }]).then(function(s) {\n                var userid = args.userid;\n                var reportinstance = args.reportinstance;\n                var formid = \"form_sendsms\" + userid;\n                var container = $(\"#sendsms_\" + reportinstance + '_' + userid).parents('table');\n                if ($('#ls_sendsms_' + reportinstance + '_' + userid).length < 1) {\n                    $(\"#sendsms_\" + reportinstance + '_' + userid).append('<div id=\"ls_sendsms_' + reportinstance + '_' +\n                    userid + '\" class=\"sendmessage\"><div class=\"messageloading\"></div><form id=\"' + formid +\n                    '\" ><textarea id=\"text_' + formid +\n                    '\" type=\"text\" name=\"message\"></textarea><input type=\"submit\" value = \"Submit\"></form></div>');\n                }\n                var dlg = $('#ls_sendsms_' + reportinstance + '_' + userid).dialog({\n                    resizable: true,\n                    autoOpen: false,\n                    width: \"20%\",\n                    title: s[0],\n                    modal: false,\n                    dialogClass: 'sendsmsdialog',\n                    show: {\n                        effect: \"slide\",\n                        duration: 1000\n                    },\n                    position: {\n                        my: \"left\",\n                        at: \"right\",\n                        of: \"#sendsms_\" + reportinstance + '_' + userid,\n                        within: container\n                    },\n                    open: function() {\n                        $(this).closest(\".ui-dialog\")\n                            .find(\".ui-dialog-titlebar-close\")\n                            .removeClass(\"ui-dialog-titlebar-close\")\n                            .html(\"<span class='ui-button-icon-primary ui-icon ui-icon-closethick'></span>\");\n                            var Closebutton = $('.ui-icon-closethick').parent();\n                            $(Closebutton).attr({\n                                \"title\": \"Close\"\n                            });\n                        $(\".sendmessage\").not(this).each(function() {\n                            $(this).remove();\n                        });\n                    },\n                    close: function() {\n                        $(this).dialog('destroy').remove();\n                    }\n                });\n                dlg.dialog(\"open\");\n                $(\"#\" + formid).submit(function(e) {\n                    e.preventDefault();\n                    var helper = require('block_learnerscript/helper');\n                    var emptymessage = document.getElementById(\"text_\" + formid).value;\n                    if (!emptymessage) {\n                        $('.messageloading').html('<div class=\"alert alert-danger\">You must supply a value here</div>');\n                    } else {\n                        var url = require('core/url');\n                        $('.messageloading').html('<center><img src=\"' + url.imageUrl(\"loader\", \"block_learnerscript\") +\n                        '\" alt=\"Message Sending\" title=\"Message Sending\"/></center>');\n                        $(\"#\" + formid).hide();\n                        var promise = Ajax.call([{\n                            methodname: 'core_message_send_instant_messages',\n                            args: {\n                                messages: [{\n                                    touserid: args.userid,\n                                    text: $(\"#\" + formid).serializeObject().message,\n                                    textformat: 0\n                                }]\n                            }\n                        }]);\n                        promise[0].done(function() {\n                            var message = s[2] + username;\n                            helper.notifications(message);\n                            dlg.dialog(\"close\");\n                        }).fail(function(ex) {\n                            // Do something with the exception\n                            $('.messageloading').html('<div class=\"alert alert-warning\">' + ex.message + '</div>');\n                        });\n                    }\n                });\n                return 'true';\n            }).fail();\n            },\n            ViewReportFilters: function(args) {\n                $('.' + args.activefilter).toggleClass(\"show\");\n                $('.' + args.inactivefilter).removeClass(\"show\");\n            },\n            deleteConfirm: function(args) {\n                return Str.get_strings([{\n                    key: 'deleteconfirmation',\n                    component: 'block_learnerscript'\n                }, {\n                    key: 'deleteallconfirm',\n                    component: 'block_learnerscript'\n                }, {\n                    key: 'graphdeleted',\n                    component: 'block_learnerscript'\n                }, {\n                    key: 'graphcannotbedeleted',\n                    component: 'block_learnerscript'\n                }]).then(function(s) {\n                    ModalFactory.create({\n                        title: s[0],\n                        type: ModalFactory.types.SAVE_CANCEL,\n                        body: s[1]\n                    }).done(function(modal) {\n                        this.modal = modal;\n                        modal.setSaveButtonText('Confirm');\n                        modal.getRoot().on(ModalEvents.save, function(e) {\n                            e.preventDefault();\n                            var helper = require('block_learnerscript/helper');\n                            var promise = Ajax.call([{\n                                methodname: 'block_learnerscript_' + args.action,\n                                args: args\n                            }]);\n                            promise[0].done(function() {\n                                $('.plotgraphcontainer').removeClass('show').addClass('hide');\n                                $('#plotreportcontainer' + args.reportid).html('');\n                                var tabdata = $('#' + args.cid).attr('aria-controls');\n                                $(\"[data-cid='\" + args.cid + \"']\").remove();\n                                $('#' + tabdata).remove();\n                                if ($(\"#report_plottabs li:eq(0) a\").length < 1) {\n                                    $('#report_plottabs').remove();\n                                }\n\n                                helper.notifications(s[2]);\n                            }).fail();\n                            modal.hide();\n                            modal.destroy();\n                        });\n                        modal.show();\n                        $('.modal-header button.close').attr('title', 'Close');\n                    }.bind(this));\n                }.bind(this));\n            },\n            validatebasicform: function(validate) {\n                var getreport = [];\n                if (typeof validate == 'undefined') {\n                    $.each($('.basicparamsform select'), function(index, value) {\n                        var selectedval = $(value).val();\n                        if (selectedval == 0) {\n                            getreport.push(0);\n                        }\n                    });\n                }\n                return getreport;\n            },\n            /**\n             * Central method for call Select2 with Ajax in reports module\n             * @param {object} args Object with reportID and other required params\n             */\n            Select2Ajax: function(args) {\n                $(\"select[data-select2-ajax='1']\").each(function() {\n                    var instanceid = $(this).data('instanceid');\n                    var reportinstance = instanceid ? instanceid : args.reportid;\n                    if (args.action == 'rolewiseusers') {\n                        args.reportid = $(this).data('reportid');\n                        args.courses = $('[name=\"filter_courses\"]').val();\n                    }\n                    if (args.action === 'userlist') {\n                        args.setminimumInputLength = 2;\n                        args.courses = $('[name=\"filter_courses\"]').val();\n                    }\n                    if (!$(this).hasClass('select2-hidden-accessible')) {\n                        var $blockname;\n                        var methodname2;\n                        $(this).select2({\n                            ajax: {\n                                data: function(params) {\n                                    var dataaction = $(this).data('action');\n\n                                    if (dataaction == 'filterusers' || dataaction == 'filter_courses') {\n                                        args.action = dataaction;\n                                        args.basicparamdata = JSON.stringify(smartfilter.BasicparamsData(reportinstance));\n                                        args.fiterdata = JSON.stringify(smartfilter.FilterData(reportinstance));\n                                        args.reportinstanceid = instanceid;\n                                        args.courses = $('[name=\"filter_courses\"]').val();\n\n                                    }\n                                    if (args.action == 'rolewiseusers') {\n                                        delete args.schuserslist;\n                                        delete args.scheduleid;\n                                        args.roleid = $(\"#id_role\" + reportinstance).val();\n                                        var roleid = args.roleid.split('_');\n                                        args.roleid = roleid[0];\n                                        args.contextlevel = roleid[1];\n                                        args.courses = $('[name=\"filter_courses\"]').val();\n\n                                    }\n                                    $.extend(params, args);\n                                    methodname2 = args.action;\n                                    if (methodname2 === 'userlist') {\n                                        $blockname = 'block_reportdashboard_';\n                                    } else {\n                                        $blockname = 'block_learnerscript_';\n                                    }\n\n                                    return params;\n                                },\n                                transport: function(params, success) {\n                                    var promise = Ajax.call([{\n                                        methodname: $blockname + methodname2,\n                                        args: params.data\n                                    }]);\n                                    promise[0].done(function(data) {\n                                        data = $.parseJSON(data);\n                                        success(data);\n                                    });\n                                    promise[0].fail(function() {\n                                        // Do something with the exception\n                                    });\n                                },\n                                processResults: function(data, params) {\n                                    // Parse the results into the format expected by Select2\n                                    // since we are using custom formatting functions we do not need to\n                                    // alter the remote JSON data, except to indicate that infinite\n                                    // scrolling can be used\n                                    params.page = params.page || 1;\n                                    var pagination = false;\n                                    if (args.action === 'userlist' || args.action == 'filter_courses'\n                                    || args.action == 'filterusers') {\n                                        pagination = false;\n                                    } else {\n                                        pagination = (params.page * 10) < data.total_count;\n                                    }\n                                    return {\n                                        results: data.items,\n                                        pagination: {\n                                                more: pagination\n                                        }\n                                    };\n                                }\n                            },\n                            escapeMarkup: function(markup) {\n                                return markup;\n                            }, // Let our custom formatter work\n                            minimumInputLength: args.setminimumInputLength || 1,\n                            maximumSelectionLength: args.maximumSelectionLength,\n                            language: {\n                                // You can find all of the options in the language files provided in the\n                                // build. They all must be functions that return the string that should be\n                                // displayed.\n                                maximumSelected: function(params) {\n                                    if (args.action == 'rolewiseusers') {\n                                        args.roleid = $(\"#id_role\" + reportinstance).val();\n                                        args.schuserslist = $('#schuserslist' + reportinstance).val();\n                                        args.scheduleid = $(\"#scheduleid\").val() || -1;\n                                        return \"Click <a href='javascript:void(0);' class='seluser' id='addusers\" + args.reportid +\n                                        \"' data-reportid=\" + args.reportid + \" data-scheduleid = \" + args.scheduleid +\n                                        \"onclick = '(function(e){ require(\\\"block_learnerscript/schedule\\\").manageschusers(\" +\n                                        \"{reportinstance:\" + reportinstance + \", reportid:\" + args.reportid + \",scheduleid:\" +\n                                        args.scheduleid + \",selectedroleid:\" + args.roleid + \",schuserslist:\\\"\" +\n                                        args.schuserslist + \"\\\"}) })(event)' > here </a> to add more than \" +\n                                        params.maximum + \" users.\";\n                                    } else if (args.action == 'filter_courses' || args.action == 'filterusers') {\n                                        return 'You can select only 5 values';\n                                    }\n                                }\n                            },\n                            templateResult: function formatRepo(repo) {\n                                var markup;\n                                if (repo.loading) {\n                                    return repo.text || \"Values not supported\";\n                                }\n                                markup = repo.text || \"Values not supported\";\n                                return markup;\n                            }, // Omitted for brevity, see the source of this page\n                            templateSelection: function formatRepoSelection(repo) {\n                                var markup;\n                                if (repo.id == -1 && args.action == 'rolewiseusers') {\n                                    var reportid = repo.element.form.dataset.reportid || 0;\n                                    var scheduleid = repo.element.form.dataset.scheduleid || -1;\n                                    markup = \"<a href='javascript:void(0)' class='viewschusers'\" +\n                                        \"onclick='(function(e){ require(\\\"block_learnerscript/schedule\\\").viewschusers(\" +\n                                        \"{reportid:\" + reportid + \",scheduleid:\" + scheduleid + \", reportinstance:\" +\n                                        reportinstance + \"}) })(event);'>\" + repo.text + \"</a>\";\n                                } else {\n                                    markup = repo.text;\n                                }\n                                return markup;\n                            } // Omitted for brevity, see the source of this page\n                        }).on('select2:select', function() {\n                            if (args.action == 'reportlist') {\n                                var reportid = $(this).val();\n                                window.location = M.cfg.wwwroot + '/blocks/learnerscript/viewreport.php?id=' + reportid;\n                            }\n                        });\n                    }\n                });\n            },\n            getQueryParameters: function(str) {\n                return (str || document.location.search).replace(/(\\?)/, '&').split(\"&\").map(function(n) {\n                    n = n.split(\"=\");\n                    this[n[0]] = n[1];\n                    return this;\n                }.bind({}))[0];\n            },\n            DrilldownReport: function() {\n                var self = this;\n                // Drill down report\n                $('td a').click(function(e) {\n                    var url = $(this).attr('href');\n                    var drillurl = self.getQueryParameters(url);\n                    if (url.indexOf('viewreport.php') <= 0 || \"download\" in drillurl) {\n                        return;\n                    }\n                    e.preventDefault();\n                    self.ReportModelFromLink({container: $(this), url: url});\n\n                });\n            },\n            ReportModelFromLink: function(args) {\n                var tableid = args.container.parents().closest('table').attr('id');\n                var tablewidth = $(\"#\" + tableid + \"\").width();\n                var drillurl = this.getQueryParameters(args.url);\n                var reportid = parseInt(drillurl.id);\n                var filter = {};\n                if (args.url.indexOf('viewreport.php') <= 0 || \"download\" in drillurl) {\n                    return;\n                }\n                $.each(drillurl, function(key, val) {\n                    if (key.indexOf('filter') >= 0) {\n                        filter[key] = val;\n                    }\n                });\n                if ($(\"#reportcontainer\" + reportid).length == 0 || $(\"#plotreportcontainer\" + reportid).length == 0) {\n                    $('body').append('<div id=\"reportcontainer' + reportid + '\" style=\"display:none;\"></div>');\n                    $('body').append('<div id=\"plotreportcontainer' + reportid +\n                    '\" class=\"dialogplot\" style=\"display:none;\"></div>');\n                    var promise = ajax.call({\n                        args: {\n                            action: 'disablecolumnstatus',\n                            reportid: reportid\n                        },\n                        url: M.cfg.wwwroot + \"/blocks/learnerscript/ajax.php\",\n                    });\n                    var dialogid;\n                    promise.done(function(response) {\n                        var reporttypes = response;\n                        reportwidget.CreateDashboardwidget({\n                            reportid: reportid,\n                            reporttype: response,\n                            basicparams: JSON.stringify(filter),\n                            lsfstartdate: 0,\n                            lsfenddate: $.now()\n                        });\n                        chart.SparkLineReport();\n                        if (reporttypes == 'table') {\n                            dialogid = \"reportcontainer\";\n                        } else {\n                            dialogid = \"plotreportcontainer\";\n                        }\n                        var dlg = $(\"#\" + dialogid + reportid + \"\").dialog({\n                            resizable: true,\n                            autoOpen: false,\n                            dialogClass: \"drilldown\" + reportid,\n                            width: tablewidth,\n                            title: '',\n                            appendTo: \"#\" + tableid,\n                            modal: true,\n                            position: {\n                                my: \"center\",\n                                at: \"top\",\n                                of: \"#\" + tableid\n                            },\n                            open: function() {\n                                $(this).closest(\".ui-dialog\")\n                                    .find(\".ui-dialog-titlebar-close\")\n                                    .removeClass(\"ui-dialog-titlebar-close\")\n                                    .html(\"<span class='ui-button-icon-primary ui-icon ui-icon-closethick'></span>\");\n                                    var Closebutton = $('.ui-icon-closethick').parent();\n                                    $(Closebutton).attr({\n                                        \"title\": \"Close\"\n                                    });\n                                $(\".drilldown\" + reportid).append('<a href=' + args.url +\n                                '><span class=\"reportdashboard_right\">View more</span></a>');\n                            },\n                            close: function() {\n                                $(this).dialog('destroy').remove();\n                            }\n                        });\n                        dlg.dialog(\"open\").prev(\".ui-dialog-titlebar\").css(\"color\", \"#0C75B6\");\n                    });\n                }\n            },\n            PlotForm: function(args) {\n                var url = M.cfg.wwwroot + '/blocks/learnerscript/ajax.php';\n                args.title = (!args.title) ? 'Plot Graph' : args.title;\n                AjaxForms.init(args, url);\n            },\n            dropdown: function(child) {\n                $('#' + child).toggle();\n            },\n            notifications: function(elements, notifytype) {\n                notifytype = notifytype || 'success';\n                $.notify({\n                    message: elements\n                }, {\n                    type: notifytype\n                }\n                );\n            },\n            rolesforcontext: function(contextlevel, reportid) {\n                var promise = ajax.call({\n                    args: {\n                        action: 'contextroles',\n                        contextlevel: contextlevel,\n                        reportid: reportid\n                    },\n                    url: M.cfg.wwwroot + \"/blocks/learnerscript/ajax.php\",\n                });\n                promise.done(function(response) {\n                    var template = '';\n                    $.each(response, function(key, value) {\n                        template += '<option value = ' + key + '>' + value + '</option>';\n                    });\n                    $(\"#id_roleid\").find('option').remove().end().append(template);\n                });\n            }\n        };\n        return helper;\n    });\n"],"names":["define","$","ajax","AjaxForms","Str","ModalFactory","ModalEvents","Ajax","notification","smartfilter","reportwidget","chart","sendmessage","args","username","get_strings","key","component","then","s","userid","reportinstance","formid","container","parents","length","append","dlg","dialog","resizable","autoOpen","width","title","modal","dialogClass","show","effect","duration","position","my","at","of","within","open","this","closest","find","removeClass","html","Closebutton","parent","attr","not","each","remove","close","submit","e","preventDefault","helper","require","document","getElementById","value","url","imageUrl","hide","call","methodname","messages","touserid","text","serializeObject","message","textformat","done","notifications","fail","ex","ViewReportFilters","activefilter","toggleClass","inactivefilter","deleteConfirm","create","type","types","SAVE_CANCEL","body","setSaveButtonText","getRoot","on","save","action","addClass","reportid","tabdata","cid","destroy","bind","validatebasicform","validate","getreport","index","val","push","Select2Ajax","$blockname","methodname2","instanceid","data","courses","setminimumInputLength","hasClass","select2","params","dataaction","basicparamdata","JSON","stringify","BasicparamsData","fiterdata","FilterData","reportinstanceid","schuserslist","scheduleid","roleid","split","contextlevel","extend","transport","success","promise","parseJSON","processResults","page","pagination","total_count","results","items","more","escapeMarkup","markup","minimumInputLength","maximumSelectionLength","language","maximumSelected","maximum","templateResult","repo","loading","templateSelection","id","element","form","dataset","window","location","M","cfg","wwwroot","getQueryParameters","str","search","replace","map","n","DrilldownReport","self","click","drillurl","indexOf","ReportModelFromLink","tableid","tablewidth","parseInt","filter","response","reporttypes","CreateDashboardwidget","reporttype","basicparams","lsfstartdate","lsfenddate","now","SparkLineReport","appendTo","prev","css","PlotForm","init","dropdown","child","toggle","elements","notifytype","notify","rolesforcontext","template","end"],"mappings":"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"}