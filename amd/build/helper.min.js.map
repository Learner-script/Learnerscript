{"version":3,"file":"helper.min.js","sources":["../src/helper.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Define the function with a clear and descriptive name, and then call it from other functions or code blocks as needed\n *\n * @module     block_learnerscript/helper\n * @copyright  2023 Moodle India Information Solutions Private Limited\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery',\n        'block_learnerscript/ajax',\n        'block_learnerscript/ajaxforms',\n        'core/str',\n        'core/modal_factory',\n        'core/modal_events',\n        'core/ajax',\n        'core/notification',\n        'block_learnerscript/smartfilter',\n        'block_learnerscript/reportwidget',\n        'block_learnerscript/chart'\n    ],\n    function($, ajax, AjaxForms, Str, ModalFactory, ModalEvents, Ajax, notification, smartfilter,\n                reportwidget, chart) {\n        var helper = {\n            sendmessage: function(args, username) {\n                    Str.get_strings([{\n                    key: 'sendmessage',\n                    component: 'block_learnerscript'\n                }, {\n                    key: 'messageconfirmation',\n                    component: 'block_learnerscript'\n                }, {\n                    key: 'messagesent',\n                    component: 'block_learnerscript'\n                }]).then(function(s) {\n                var userid = args.userid;\n                var reportinstance = args.reportinstance;\n                var formid = \"form_sendsms\" + userid;\n                var container = $(\"#sendsms_\" + reportinstance + '_' + userid).parents('table');\n                if ($('#ls_sendsms_' + reportinstance + '_' + userid).length < 1) {\n                    $(\"#sendsms_\" + reportinstance + '_' + userid).append('<div id=\"ls_sendsms_' + reportinstance + '_' +\n                    userid + '\" class=\"sendmessage\"><div class=\"messageloading\"></div><form id=\"' + formid +\n                    '\" ><textarea id=\"text_' + formid +\n                    '\" type=\"text\" name=\"message\"></textarea><input type=\"submit\" value = \"Submit\"></form></div>');\n                }\n                var dlg = $('#ls_sendsms_' + reportinstance + '_' + userid).dialog({\n                    resizable: true,\n                    autoOpen: false,\n                    width: \"20%\",\n                    title: s[0],\n                    modal: false,\n                    dialogClass: 'sendsmsdialog',\n                    show: {\n                        effect: \"slide\",\n                        duration: 1000\n                    },\n                    position: {\n                        my: \"left\",\n                        at: \"right\",\n                        of: \"#sendsms_\" + reportinstance + '_' + userid,\n                        within: container\n                    },\n                    open: function() {\n                        $(this).closest(\".ui-dialog\")\n                            .find(\".ui-dialog-titlebar-close\")\n                            .removeClass(\"ui-dialog-titlebar-close\")\n                            .html(\"<span class='ui-button-icon-primary ui-icon ui-icon-closethick'></span>\");\n                            var Closebutton = $('.ui-icon-closethick').parent();\n                            $(Closebutton).attr({\n                                \"title\": \"Close\"\n                            });\n                        $(\".sendmessage\").not(this).each(function() {\n                            $(this).remove();\n                        });\n                    },\n                    close: function() {\n                        $(this).dialog('destroy').remove();\n                    }\n                });\n                dlg.dialog(\"open\");\n                $(\"#\" + formid).submit(function(e) {\n                    e.preventDefault();\n                    var helper = require('block_learnerscript/helper');\n                    var emptymessage = document.getElementById(\"text_\" + formid).value;\n                    if (!emptymessage) {\n                        $('.messageloading').html('<div class=\"alert alert-danger\">You must supply a value here</div>');\n                    } else {\n                        var url = require('core/url');\n                        $('.messageloading').html('<center><img src=\"' + url.imageUrl(\"loader\", \"block_learnerscript\") +\n                        '\" alt=\"Message Sending\" title=\"Message Sending\"/></center>');\n                        $(\"#\" + formid).hide();\n                        var promise = Ajax.call([{\n                            methodname: 'core_message_send_instant_messages',\n                            args: {\n                                messages: [{\n                                    touserid: args.userid,\n                                    text: $(\"#\" + formid).serializeObject().message,\n                                    textformat: 0\n                                }]\n                            }\n                        }]);\n                        promise[0].done(function() {\n                            var message = s[2] + username;\n                            helper.notifications(message);\n                            dlg.dialog(\"close\");\n                        }).fail(function(ex) {\n                            // Do something with the exception\n                            $('.messageloading').html('<div class=\"alert alert-warning\">' + ex.message + '</div>');\n                        });\n                    }\n                });\n                return 'true';\n            }).fail();\n            },\n            ViewReportFilters: function(args) {\n                $('.' + args.activefilter).toggleClass(\"show\");\n                $('.' + args.inactivefilter).removeClass(\"show\");\n            },\n            deleteConfirm: function(args) {\n                return Str.get_strings([{\n                    key: 'deleteconfirmation',\n                    component: 'block_learnerscript'\n                }, {\n                    key: 'deleteallconfirm',\n                    component: 'block_learnerscript'\n                }]).then(function(s) {\n                    ModalFactory.create({\n                        title: s[0],\n                        type: ModalFactory.types.SAVE_CANCEL,\n                        body: s[1]\n                    }).done(function(modal) {\n                        this.modal = modal;\n                        modal.setSaveButtonText('Confirm');\n                        modal.getRoot().on(ModalEvents.save, function(e) {\n                            e.preventDefault();\n                            var helper = require('block_learnerscript/helper');\n                            var promise = Ajax.call([{\n                                methodname: 'block_learnerscript_' + args.action,\n                                args: args\n                            }]);\n                            promise[0].done(function() {\n                                $('.plotgraphcontainer').removeClass('show').addClass('hide');\n                                $('#plotreportcontainer' + args.reportid).html('');\n                                var tabdata = $('#' + args.cid).attr('aria-controls');\n                                $(\"[data-cid='\" + args.cid + \"']\").remove();\n                                $('#' + tabdata).remove();\n                                if ($(\"#report_plottabs li:eq(0) a\").length < 1) {\n                                    $('#report_plottabs').remove();\n                                }\n\n                                helper.notifications(s[2]);\n                            }).fail();\n                            modal.hide();\n                            modal.destroy();\n                        });\n                        modal.show();\n                        $('.modal-header button.close').attr('title', 'Close');\n                    }.bind(this));\n                }.bind(this));\n            },\n            validatebasicform: function(validate) {\n                var getreport = [];\n                if (typeof validate == 'undefined') {\n                    $.each($('.basicparamsform select'), function(index, value) {\n                        var selectedval = $(value).val();\n                        if (selectedval == 0) {\n                            getreport.push(0);\n                        }\n                    });\n                }\n                return getreport;\n            },\n            /**\n             * Central method for call Select2 with Ajax in reports module\n             * @param {object} args Object with reportID and other required params\n             */\n            Select2Ajax: function(args) {\n                $(\"select[data-select2-ajax='1']\").each(function() {\n                    var instanceid = $(this).data('instanceid');\n                    var reportinstance = instanceid ? instanceid : args.reportid;\n                    if (args.action == 'rolewiseusers') {\n                        args.reportid = $(this).data('reportid');\n                        args.courses = $('[name=\"filter_courses\"]').val();\n                    }\n                    if (args.action === 'userlist') {\n                        args.setminimuminputlength = 2;\n                        args.courses = $('[name=\"filter_courses\"]').val();\n                    }\n                    if (!$(this).hasClass('select2-hidden-accessible')) {\n                        var $blockname;\n                        var methodname2;\n                        $(this).select2({\n                            ajax: {\n                                data: function(params) {\n                                    var dataaction = $(this).data('action');\n\n                                    if (dataaction == 'filterusers' || dataaction == 'filter_courses') {\n                                        args.action = dataaction;\n                                        args.basicparamdata = JSON.stringify(smartfilter.BasicparamsData(reportinstance));\n                                        args.fiterdata = JSON.stringify(smartfilter.FilterData(reportinstance));\n                                        args.reportinstanceid = instanceid;\n                                        args.courses = $('[name=\"filter_courses\"]').val();\n\n                                    }\n                                    if (args.action == 'rolewiseusers') {\n                                        delete args.schuserslist;\n                                        delete args.scheduleid;\n                                        args.roleid = $(\"#id_role\" + reportinstance).val();\n                                        var roleid = args.roleid.split('_');\n                                        args.roleid = roleid[0];\n                                        args.contextlevel = roleid[1];\n                                        args.courses = $('[name=\"filter_courses\"]').val();\n\n                                    }\n                                    $.extend(params, args);\n                                    methodname2 = args.action;\n                                    if (methodname2 === 'userlist') {\n                                        $blockname = 'block_reportdashboard_';\n                                    } else {\n                                        $blockname = 'block_learnerscript_';\n                                    }\n\n                                    return params;\n                                },\n                                transport: function(params, success) {\n                                    var promise = Ajax.call([{\n                                        methodname: $blockname + methodname2,\n                                        args: params.data\n                                    }]);\n                                    promise[0].done(function(data) {\n                                        data = $.parseJSON(data);\n                                        success(data);\n                                    });\n                                    promise[0].fail(function() {\n                                        // Do something with the exception\n                                    });\n                                },\n                                processResults: function(data, params) {\n                                    // Parse the results into the format expected by Select2\n                                    // since we are using custom formatting functions we do not need to\n                                    // alter the remote JSON data, except to indicate that infinite\n                                    // scrolling can be used\n                                    params.page = params.page || 1;\n                                    var pagination = false;\n                                    if (args.action === 'userlist' || args.action == 'filter_courses'\n                                    || args.action == 'filterusers') {\n                                        pagination = false;\n                                    } else {\n                                        pagination = (params.page * 10) < data.total_count;\n                                    }\n                                    return {\n                                        results: data.items,\n                                        pagination: {\n                                                more: pagination\n                                        }\n                                    };\n                                }\n                            },\n                            escapeMarkup: function(markup) {\n                                return markup;\n                            }, // Let our custom formatter work\n                            minimumInputLength: args.setminimuminputlength || 1,\n                            maximumselectionlength: args.maximumselectionlength,\n                            language: {\n                                // You can find all of the options in the language files provided in the\n                                // build. They all must be functions that return the string that should be\n                                // displayed.\n                                maximumSelected: function(params) {\n                                    if (args.action == 'rolewiseusers') {\n                                        args.roleid = $(\"#id_role\" + reportinstance).val();\n                                        args.schuserslist = $('#schuserslist' + reportinstance).val();\n                                        args.scheduleid = $(\"#scheduleid\").val() || -1;\n                                        return \"Click <a href='javascript:void(0);' class='seluser' id='addusers\" + args.reportid +\n                                        \"' data-reportid=\" + args.reportid + \" data-scheduleid = \" + args.scheduleid +\n                                        \"onclick = '(function(e){ require(\\\"block_learnerscript/schedule\\\").manageschusers(\" +\n                                        \"{reportinstance:\" + reportinstance + \", reportid:\" + args.reportid + \",scheduleid:\" +\n                                        args.scheduleid + \",selectedroleid:\" + args.roleid + \",schuserslist:\\\"\" +\n                                        args.schuserslist + \"\\\"}) })(event)' > here </a> to add more than \" +\n                                        params.maximum + \" users.\";\n                                    } else if (args.action == 'filter_courses' || args.action == 'filterusers') {\n                                        return 'You can select only 5 values';\n                                    }\n                                }\n                            },\n                            templateResult: function formatRepo(repo) {\n                                var markup;\n                                if (repo.loading) {\n                                    return repo.text || \"Values not supported\";\n                                }\n                                markup = repo.text || \"Values not supported\";\n                                return markup;\n                            }, // Omitted for brevity, see the source of this page\n                            templateSelection: function formatRepoSelection(repo) {\n                                var markup;\n                                if (repo.id == -1 && args.action == 'rolewiseusers') {\n                                    var reportid = repo.element.form.dataset.reportid || 0;\n                                    var scheduleid = repo.element.form.dataset.scheduleid || -1;\n                                    markup = \"<a href='javascript:void(0)' class='viewschusers'\" +\n                                        \"onclick='(function(e){ require(\\\"block_learnerscript/schedule\\\").viewschusers(\" +\n                                        \"{reportid:\" + reportid + \",scheduleid:\" + scheduleid + \", reportinstance:\" +\n                                        reportinstance + \"}) })(event);'>\" + repo.text + \"</a>\";\n                                } else {\n                                    markup = repo.text;\n                                }\n                                return markup;\n                            } // Omitted for brevity, see the source of this page\n                        }).on('select2:select', function() {\n                            if (args.action == 'reportlist') {\n                                var reportid = $(this).val();\n                                window.location = M.cfg.wwwroot + '/blocks/learnerscript/viewreport.php?id=' + reportid;\n                            }\n                        });\n                    }\n                });\n            },\n            getQueryParameters: function(str) {\n                return (str || document.location.search).replace(/(\\?)/, '&').split(\"&\").map(function(n) {\n                    n = n.split(\"=\");\n                    this[n[0]] = n[1];\n                    return this;\n                }.bind({}))[0];\n            },\n            DrilldownReport: function() {\n                var self = this;\n                // Drill down report\n                $('td a').click(function(e) {\n                    var url = $(this).attr('href');\n                    var drillurl = self.getQueryParameters(url);\n                    if (url.indexOf('viewreport.php') <= 0 || \"download\" in drillurl) {\n                        return;\n                    }\n                    e.preventDefault();\n                    self.ReportModelFromLink({container: $(this), url: url});\n\n                });\n            },\n            ReportModelFromLink: function(args) {\n                var tableid = args.container.parents().closest('table').attr('id');\n                var tablewidth = $(\"#\" + tableid + \"\").width();\n                var drillurl = this.getQueryParameters(args.url);\n                var reportid = parseInt(drillurl.id);\n                var filter = {};\n                if (args.url.indexOf('viewreport.php') <= 0 || \"download\" in drillurl) {\n                    return;\n                }\n                $.each(drillurl, function(key, val) {\n                    if (key.indexOf('filter') >= 0) {\n                        filter[key] = val;\n                    }\n                });\n                if ($(\"#reportcontainer\" + reportid).length == 0 || $(\"#plotreportcontainer\" + reportid).length == 0) {\n                    $('body').append('<div id=\"reportcontainer' + reportid + '\" style=\"display:none;\"></div>');\n                    $('body').append('<div id=\"plotreportcontainer' + reportid +\n                    '\" class=\"dialogplot\" style=\"display:none;\"></div>');\n                    var promise = ajax.call({\n                        args: {\n                            action: 'disablecolumnstatus',\n                            reportid: reportid\n                        },\n                        url: M.cfg.wwwroot + \"/blocks/learnerscript/ajax.php\",\n                    });\n                    var dialogid;\n                    promise.done(function(response) {\n                        var reporttypes = response;\n                        require(['block_learnerscript/reportwidget'], function(reportwidget) {\n                            reportwidget.CreateDashboardwidget({\n                                reportid: reportid,\n                                reporttype: response,\n                                basicparams: JSON.stringify(filter),\n                                lsfstartdate: 0,\n                                lsfenddate: $.now()\n                            });\n                        });\n                        chart.SparkLineReport();\n                        if (reporttypes == 'table') {\n                            dialogid = \"reportcontainer\";\n                        } else {\n                            dialogid = \"plotreportcontainer\";\n                        }\n                        var dlg = $(\"#\" + dialogid + reportid + \"\").dialog({\n                            resizable: true,\n                            autoOpen: false,\n                            dialogClass: \"drilldown\" + reportid,\n                            width: tablewidth,\n                            title: '',\n                            appendTo: \"#\" + tableid,\n                            modal: true,\n                            position: {\n                                my: \"center\",\n                                at: \"top\",\n                                of: \"#\" + tableid\n                            },\n                            open: function() {\n                                $(this).closest(\".ui-dialog\")\n                                    .find(\".ui-dialog-titlebar-close\")\n                                    .removeClass(\"ui-dialog-titlebar-close\")\n                                    .html(\"<span class='ui-button-icon-primary ui-icon ui-icon-closethick'></span>\");\n                                    var Closebutton = $('.ui-icon-closethick').parent();\n                                    $(Closebutton).attr({\n                                        \"title\": \"Close\"\n                                    });\n                                Str.get_string('viewmore', 'block_learnerscript').then(function(s) {\n                                    $(\".drilldown\" + reportid).append('<a href=' + args.url +\n                                    '><span class=\"reportdashboard_right\">' + s + '</span></a>');\n                                });\n                            },\n                            close: function() {\n                                $(this).dialog('destroy').remove();\n                            }\n                        });\n                        dlg.dialog(\"open\").prev(\".ui-dialog-titlebar\").css(\"color\", \"#0C75B6\");\n                    });\n                }\n            },\n            PlotForm: function(args) {\n                var url = M.cfg.wwwroot + '/blocks/learnerscript/ajax.php';\n                args.title = (!args.title) ? 'Plot Graph' : args.title;\n                AjaxForms.init(args, url);\n            },\n            dropdown: function(child) {\n                $('#' + child).toggle();\n            },\n            notifications: function(elements, notifytype) {\n                notifytype = notifytype || 'success';\n                $.notify({\n                    message: elements\n                }, {\n                    type: notifytype\n                }\n                );\n            },\n            rolesforcontext: function(contextlevel, reportid) {\n                var promise = ajax.call({\n                    args: {\n                        action: 'contextroles',\n                        contextlevel: contextlevel,\n                        reportid: reportid\n                    },\n                    url: M.cfg.wwwroot + \"/blocks/learnerscript/ajax.php\",\n                });\n                promise.done(function(response) {\n                    var template = '';\n                    $.each(response, function(key, value) {\n                        template += '<option value = ' + key + '>' + value + '</option>';\n                    });\n                    $(\"#id_roleid\").find('option').remove().end().append(template);\n                });\n            }\n        };\n        return helper;\n    });\n"],"names":["define","$","ajax","AjaxForms","Str","ModalFactory","ModalEvents","Ajax","notification","smartfilter","reportwidget","chart","helper","sendmessage","args","username","get_strings","key","component","then","s","userid","reportinstance","formid","container","parents","length","append","dlg","dialog","resizable","autoOpen","width","title","modal","dialogClass","show","effect","duration","position","my","at","of","within","open","this","closest","find","removeClass","html","Closebutton","parent","attr","not","each","remove","close","submit","e","preventDefault","require","document","getElementById","value","url","imageUrl","hide","call","methodname","messages","touserid","text","serializeObject","message","textformat","done","notifications","fail","ex","ViewReportFilters","activefilter","toggleClass","inactivefilter","deleteConfirm","create","type","types","SAVE_CANCEL","body","setSaveButtonText","getRoot","on","save","action","addClass","reportid","tabdata","cid","destroy","bind","validatebasicform","validate","getreport","index","val","push","Select2Ajax","$blockname","methodname2","instanceid","data","courses","setminimuminputlength","hasClass","select2","params","dataaction","basicparamdata","JSON","stringify","BasicparamsData","fiterdata","FilterData","reportinstanceid","schuserslist","scheduleid","roleid","split","contextlevel","extend","transport","success","promise","parseJSON","processResults","page","pagination","total_count","results","items","more","escapeMarkup","markup","minimumInputLength","maximumselectionlength","language","maximumSelected","maximum","templateResult","repo","loading","templateSelection","id","element","form","dataset","window","location","M","cfg","wwwroot","getQueryParameters","str","search","replace","map","n","DrilldownReport","self","click","drillurl","indexOf","ReportModelFromLink","tableid","tablewidth","parseInt","filter","response","reporttypes","CreateDashboardwidget","reporttype","basicparams","lsfstartdate","lsfenddate","now","SparkLineReport","appendTo","get_string","prev","css","PlotForm","init","dropdown","child","toggle","elements","notifytype","notify","rolesforcontext","template","end"],"mappings":"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"}